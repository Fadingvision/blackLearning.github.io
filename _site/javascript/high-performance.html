<!DOCTYPE html>
<html>
    <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>高性能js学习笔记</title>
    <meta name="description" content="高性能js学习笔记 - blackLearning's blog - (fuyigekua@foxmail.com)">

    <link rel="stylesheet" href=" /css/bootstrap.min.css ">
    <link rel="stylesheet" href=" /css/main.css ">
    <link rel="shortcut icon" href="/img/favicon.ico"/>
    <link rel="bookmark" href="/img/favicon.ico"/>
</head>

<body>
    <div class="skin-container"></div>
    <header>
    <div class="container">
        <div class="row">
            <div class="col-sm-12">
                <p class="header-content">
                    天亮的日子还多着呢,太阳不过是一颗晓星
                </p>
            </div>
        </div>
    </div>
</header>


    <nav class="main-navgation">
        <div class="container">
            <div class="row">
                <div class="col-md-3"></div>
                <div class="col-md-6">
                    <div class="nav navbar-default">
                        <div class="navbar-header">
                            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbarCollapse">
                                <span class="sr-only">Toggle navigation</span>
                                <span class="icon-bar"></span>
                                <span class="icon-bar"></span>
                                <span class="icon-bar"></span>
                            </button>
                        </div>
                        <div class="collapse navbar-collapse" id="navbarCollapse">
                            <ul class="nav navbar-nav">
                                <li><a href="/index.html">首 页</a></li>
                                <li><a href="/categories.html">分 类</a></li>
                                <li><a href="/tags.html">标 签</a></li>
                                <li><a href="/archives.html">归 档</a></li>
                                <li><a href="/about.html">关 于</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="col-md-3"></div>
            </div>
        </div>
    </nav>
    <section class="content-container">
        <div class="container">
            <div class="row">
                <div class="col-md-8">
                    <!-- post.html -->
                    <article class="post-details">
                        <div class="post-head">
                            <h2 class="post-title">高性能js学习笔记</h3>
                            <p class="post-date"><span class="glyphicon glyphicon-time"></span>04 Jan 2016</p>
                        </div>
                        <h3>高性能JavaScript学习笔记</h3>

<h4>一、加载和执行</h4>

<ol>
<li>脚本文件应该放在body标签的最后面。</li>
<li>合并多个script以减少Http请求。</li>
<li>无阻塞的脚本：</li>
<li>为script标签添加defer属性（仅ie 和firefox支持）</li>
<li>使用dom操作动态加载脚本。（推荐）</li>
</ol>


<pre><code class="js ">function loadScript(url,callback) {
    var script= document.createElement('script');
    script.type = 'text/javascript';
    script.onload = function() {
        callback &amp;&amp; callback();
    };
    script.src= url;
    var head = document.getElementsByTagName('head')[0];
    head.appendChild(script);
}
</code></pre>

<p>先添加动态加载方法所需的代码（loadscript），然后使用loadScript加载所需的Js文件
- 使用xhr对象获取脚本（不能跨域从cdn下载js文件）。</p>

<hr />

<h4>二、数据访问</h4>

<ol>
<li>使用直接量和局部变量来读取数据，减少使用数组和对象。</li>
<li>尽可能的使用局部变量而不是全局变量。经验法则：<strong>如果某个跨作用域的值在函数中不只被引用一次，那么就应该用局部变量来保存它。</strong></li>
<li>eval, with, try catch语句都有可能会影响作用域链，谨慎使用。</li>
<li><strong>搜索实例成员从比直接量或局部变量中访问数据代价更高。</strong></li>
<li>每次遇到点操作符，嵌套成员会导致js引擎搜索所有对象成员。所以：<strong>在函数中如果要多次读取同一个对象属性，最佳做法是将属性值保存到一个局部变量中</strong></li>
</ol>


<hr />

<h4>三、DOM编程</h4>

<ol>
<li><strong>减少dom访问的次数</strong>，innerHTML在大部分情况下比原生DOM方法快。</li>
<li>在循环dom节点的时候，应该先缓存length。</li>
<li>使用children，firstElementChild，nextElementSibiling等更快的方法代替childNodes等属性。</li>
<li>如果浏览器允许，使用原生的querySelectorAll(),querySelector()等方法来进行节点查找。</li>
<li>当添加和删除dom节点，改变元素宽高位置或者内容时，浏览器都会发生<strong>“重排”</strong>，损耗性能。所以当减少以上的操作。技巧：</li>
<li>改变样式时，使用cssText批量修改。如果样式不依赖逻辑和运算的情况下，只需要改变Class类名，把css的修改留给样式表来完成。</li>
<li>当需要对dom节点进行一系列修改时，可以采用先把Dom节点脱离文档流，待修改完毕之后再加入文档流中。三种基本方法：1.隐藏元素，修改元素，显示元素。2.使用文档碎片(documentfragment)来加入新的片段。（<strong>推荐</strong>）3.将原始元素考本到一个脱离文档的节点中，修改副本，然后拷贝回文档。</li>
<li>缓存布局信息。</li>
<li>对动画元素使用绝对定位，使其脱离文档流，减少重排。</li>
<li>避免大量使用：hover伪类。</li>
<li>当存在大量重复的事件绑定时，使用事件委托。</li>
</ol>


<hr />

<h4>四、算法和流程控制</h4>

<ol>
<li>优化循环：</li>
<li>减少对象成员及数组项的查找次数。（缓存length属性）</li>
<li><p>减少迭代的次数</p></li>
<li><p>条件语句：条件数量多用switch，条件数量少用if else. 且if else 中的条件语句总是从<strong>大概率到小概率</strong>这样排列。</p></li>
</ol>


<hr />

<h4>五、字符串和正则表达式</h4>

<ol>
<li>+ 和+=符号的使用：通常来说避免str += "one" + "two",这样的写法，而改成str += "one"; str += "two";更好。</li>
<li>正则技巧：正则以简单、必须的字元开始；使用量词模式，使他们后面的字元互斥；减少分支数量，缩小分支范围；使用非捕获组；只捕获感兴趣的部分以减少后处理等等。</li>
</ol>


<hr />

<h4>六、快速响应的用户界面</h4>

<p>由于浏览器对Js的运行时间有限制，所以使用定时器或者web workers来处理js可以突破这种限制。</p>

<h4>七、Ajax</h4>

<ol>
<li>现代浏览器中获取服务端数据的主要三种方式，XHR，动态脚本注入，multipart XHR。</li>
<li>使用XHR时，GET和POST的对比：对于那些不会改变服务器状态，只会获取数据的请求，应该使用GET。只有当请求的URL加上参数的长度接近或超过2048个字符时，才应该使用Post方法。</li>
<li>一个post请求，至少装载两个数据包，一个装载头信息，另一个装载post正文。</li>
<li>使用jsonp时，因为json数据被当成一个js文件作为原生代码执行，所以这些数据必须封装在一个回调函数里。</li>
<li>缓存数据：1、服务端，通过设置http头信息确保响应被浏览器缓存。为了保证ajax响应被缓存，必须使用get方式发送请求，而且必须在响应中发送正确的http头Expires信息。2、在客服端，把获取到的信息缓存到本地，从而避免再次请求。</li>
</ol>


<hr />

<h4>八、编程实践</h4>

<ol>
<li>使用{},[]方式创建对象和数组而不是new Object()和new Array()方式。</li>
<li>部署js应用：</li>
<li>合并Js文件</li>
<li>预处理Js文件</li>
<li>压缩js文件</li>
<li>缓存js文件</li>
<li>使用cdn（内容分发网络）</li>
</ol>


                        <div class="post-tags">
                            <span class="glyphicon glyphicon-tags"></span>
                             
                            <span class="post-tag">javascript</span>   
                             
                            <span class="post-tag">高性能</span>   
                              
                        </div>
                    </article>

                    <div class="page-container">
                        
                        
                        <a href="/javascript/js.html" class="btn btn-primary">编写高质量JavaScript的有效方法<span class="glyphicon glyphicon-chevron-right"></span></a>
                        
                    </div>
                   

                </div>
                <div class="col-md-4">
                    <div class="sidebar-content">
                        <div class="widget">
                            <h4 class="title"><span class="glyphicon glyphicon-search"></span>搜   索</h4>
                            <form action="" method="get">
                                <div class="input-group">
                                    <input type="text" name="q" class="form-control">
                                    <span class="input-group-btn">
                                    <button class="btn btn-primary" type="submit">
                                        <span class="glyphicon glyphicon-search"></span>
                                    </button>
                                    </span>
                                </div>
                            </form>
                        </div>
                        <div class="widget">
                            <h4 class="title"><span class="glyphicon glyphicon-calendar"></span>日  历</h4>
                            <div id="calendar">
		<p><span id="prevYear" title="上一年">&lt;&lt;</span><span id="prevMonth" title="前一月">&lt;</span><input type="text" class="date-year" id="dateYear">年<input type="" class="date-month" id="dateMonth">月<span id="nextMonth" title="后一月">&gt;</span><span id="nextYear" title="下一年">&gt;&gt;</span></p>
		<table>
			<thead>
				<td class="weekend">日</td>
				<td>一</td>
				<td>二</td>
				<td>三</td>
				<td>四</td>
				<td>五</td>
				<td class="weekend">六</td>
			</thead>
			<tbody>
				<tr>
					<td></td>
					<td></td>
					<td></td>
					<td></td>
					<td></td>
					<td></td>
					<td></td>
				</tr>
				<tr>
					<td></td>
					<td></td>
					<td></td>
					<td></td>
					<td></td>
					<td></td>
					<td></td>
				</tr>
				<tr>
					<td></td>
					<td></td>
					<td></td>
					<td></td>
					<td></td>
					<td></td>
					<td></td>
				</tr>
				<tr>
					<td></td>
					<td></td>
					<td></td>
					<td></td>
					<td></td>
					<td></td>
					<td></td>
				</tr>
				<tr>
					<td></td>
					<td></td>
					<td></td>
					<td></td>
					<td></td>
					<td></td>
					<td></td>
				</tr>
				<tr>
					<td></td>
					<td></td>
					<td></td>
					<td></td>
					<td></td>
					<td></td>
					<td></td>
				</tr>
			</tbody>
		</table>
	</div>
                        </div>
                        <div id="scrollPos">
                            <div class="widget">
                                <h4 class="title"><span class="glyphicon glyphicon-th-list"></span>分   类</h4>
                                <div class="categories">
                                    
                                    <a href="/categories.html#javascript">javascript(3)</a>
                                    
                                </div>
                            </div>
                            <div class="widget">
                                <h4 class="title"><span class="glyphicon glyphicon-link"></span>常 用 链 接</h4>
                                <div class="usefulLinks">
                                    <a href="http://www.github.com">Github</a>
                                    <a href="http://www.stackoverflow.com/">Stack Overflow</a>
                                    <a href="www.google.com">Google</a>
                                    <a href="http://segmentfault.com/">SegmentFault</a>
                                    <a href="https://developer.mozilla.org/zh-CN/">MDN</a>
                                    <a href="http://www.bootcss.com/">Bootstrap</a>
                                    <a href="http://www.zhihu.com/">知乎</a>
                                    <a href="http://www.cnblogs.com/">博客园</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <div class="comments">
        <!-- UY BEGIN -->
        <div id="uyan_frame"></div>
        <script type="text/javascript" src="http://v2.uyan.cc/code/uyan.js"></script>
        <!-- UY END -->
    </div>
        <footer>
    				<p>Copyright © blackLearning, hosted on GitHubPages, powered by Jekyll,design By bootstrap and Jquery</p>
    </footer>

    <div id="backTop">
        <span class="btn btn-danger glyphicon glyphicon-chevron-up"></span>
    </div>
    <!-- jQuery Version 1.11.3 -->
    <script src="/js/jquery-1.11.3.min.js"> </script>
    <!-- Bootstrap Core JavaScript -->
    <script src="/js/bootstrap.min.js"></script>
    <script src="/js/calendar.js"></script>
    <script src="/js/backTop.js"></script>
    <script src="/js/main.js"></script>
</body>

</html>
